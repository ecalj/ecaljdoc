We have manuals and presentations of ecalj at [.Document/](./Document). Especially, [ecaljmanual.pdf](./Document/Manual/ecaljmanual.pdf) is the main manual. Read "LDA/GGA calculations and Plots" at first (but some part become obsolate---I have to revise)
QSGW calculations can be performed easily after you learend the procedure. Band plot and so on are in the same manner of the LDA calculations, althogh QSGW is computationally expensive (roughly 100~1000 times expensive. We ara going to use GPU now.).


* How to perform paper quality calculations with minimum costs? See [./README_hints.org]()
* Usage minimum. QSGW for Si
See Section.4. of [./Document/Manual/ecaljmanual.pdf]().


## Very minimum to run ecalj


1. write structure file ctrls.si by hand 
    (you can generate ctrls from POSCAR(VASP) with vasp2ctrl in
    ecalj/StructureTool/, thus cif --> POSCAR ---> ctrls is also possible.)

2. conver ctrls.si to ctrl.si by ctrlgenM1.py si 
   (without argument, it gives a help). 
   Then you have default ctrl.si (rename ctrlgenM1.ctr.si to ctrl.si). 
   Edit number of k points, spin (nsp=0 or 1) and so on if necessary.

3. Run "lmfa si" to prepare atoms (very quick).Then run 'mpirun -np 4 lmf si'.
    This generates rst.si, which contains self-consistent density in LDA.
    Postprocessing for energy bands are job_band si, job_tdos, job_pdos are also available.
    For job_band, you need symmetry line file syml.si, which can be generated at the method implemented in GetSyml/

should generate a syml.si from ctrl.si. You can edit it and run job_band.

4. For PMT-QSGW, make GWinput.tmp by mkGWIN_v2 si. Copy GWinput.tmp as GWinput.

5. Then run a script gwsc, e.g. "gwsc 2 si -np 3" 
    (2+1 iteration with 3 nodes).

6. To continue calculation do "gwsc 5 si -np 3" again.
   To start, you need ctrl.si rst.si QGpsi sigm.si. Latest gwsc is given in python3 (adopted from that by Dr.suzuki)

7. For band, dos, and pdos plot, 
    we have scripts which almost automatically makes these plot in
    gnuplot. Thus easy to modify these plots at your desposal.
    For example, job_band is for band plot. But symmetry line path file syml.si is required.
    The syml can be generated by getsyml.py, which also visualise the pathes in the BZ.


## Memo for StructureTool/ and Getsyml/
In any calculations, we first need to supply crystal structure correctly.
In the case of ecalj, we write it ctrls.*. 
All calculaitons can be performed from it.

For this purpose, we have converters between POSCAR
(VASP's crystal structure file, Cartesian setting is needed; 'conversion bug for Fractional aug2019') 
and ctrls.*(that for ecalj). In addition, we have a simple script to invoke crystal strucrure
viewer, usually VESTA. It is in [[file:StructureTool/README.txt][StructureTool/]].

Furthermore, we have a tool to generate BZ and symmetry lines on it for
band plot in [./GetSyml/]()
The symmetry line is written into syml.* and used for the
band plot mode, job_band. The BZ and the lines are visualized.




<!--- In addition, we are going to organize [[file:Document/Manual/!CategoryAndToken.org][Document/

Manual/  
: # CategoryAndToken.org]] which explain switches in ctrl file
The ctrl file have grammer of tree-type of ordering, "Category->token->subtoken".
Varieties of samples are at [[file:MATERIALS/][MATERIALS/]] (some of them are obsolate), 
see [[file:./MATERIALS/README_MATERIALS.org][./MATERIALS/README_MATERIALS.org]]
[[./Document/Manual/CategoryAndToken.org]]
(link to titus/ is broken now).
*** MEMO
** For 4f, we need modification to GWinput.tmp
   Old memo is at [[./Document/Manual/GdQSGW4.pdf][./Document/Manual/GdQSGW4.pdf]]
   Latest version automatically set default for 4f systems.
** (for previous users): known bug(or not) for spin susceptibility mode
(This mode is now obsolate because we are switching to a new method
with localized basis for spin susceptibility.)
T.Kotani thinks epsPP\_lmfh\_chipm branch may/(or may not) have a bug
(because of symmetrization). The bug may be near
#+begin_src f90
          if (is==nspinmx) then 
            symmetrize=.true.
            call x0kf_v4hz(npm,ncc,... 
#+end_src
in SRC/main/hx0fp0.m.F
(This bug may be from a few years ago, after I implemented EIBZ mode).
I think  "if (is==nspinmx.or.chipm) then" may be necessary
especially for cases with more than two atoms in the cell
(thus fe\_epsPP\_lmfh test may not work for this case...)
A possible test is by removing symmetrization -> use eibzsym=F. 

We have old documents at [[./Document/LMF@2009/]]
These are back up files at year2009. We still have some meaningful information in it.
But this is very detailed and mainly for developers.

See [[file:Document/Manual/GdQSGW4.pdf][Document/Mamual/GdQSGW4.pdf]]

* 4f system
Default setting might be not good enough. We are preparing a paper. 

* GaussianFilterX0.
This switch in GWinput is ver'y useful and promising (probably) 
to stabilize the convergence of metallic cases
(when many bands are located at the Fermi level).


--->

