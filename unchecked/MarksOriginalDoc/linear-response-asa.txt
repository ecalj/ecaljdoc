For large systems, estimating the self-consistent density given an
input density qin and output density qout is greatly accelerated if
the dielectric response function is known.  The codes have some
capability to generate an ASA response function.

First, you need to create the ASA bare response function P0,
which I defined as
   dq = P0 dv

dv is a constant potential shift in one sphere, and dq is the change
in the 0th moment in some RL channel in another sphere.  The ASA
static dielectric response is
  eps^-1 = (1 - M' P0)^-1
where
  M' = M + (on-site term = something like intraatomic U)
and
  M = Madelung matrix.

If you have P0 stored on disk, the mixing procedure will construct
eps^-1 and then screen the (qout-qin) by eps^-1.  More exactly, it
replaces the raw qout (generated by bndasa or gfasa) by
  qout* = qin  + eps^-1 (qout-qin)
and then it proceeds with self-consistency in the usual way, using
qout* in place of the usual qout.  To tell the code to screen qout,
add a token to the ctrl file OPTIONS category: SCR=2.  The program will
crash if it can't read P0 from the disk (P0 is stored in file `psta').

You can create P0 either with the band program (lm) or in the Green's
function code (lmgf).  Since the metals treatment in the lm code is
very primitive, it is better to use only lmgf to create P0 for metals.
(lmgf can also make P0 for the noncollinear case.)  To create P0
in either `lm' or `lmgf', put in OPTIONS the token SCR=1.

The intraatomic U is estimated from the second derivative of the sphere
total energy wrt to charge.  You can update it each iteration k by adding
10*k to the token SCR= ... thus 'SCR=52' will update the U each 5th
iteration in the sphere program.

Last, to run the GF program lmgf, you need to add a couple of tokens
to the ctrl file.  See doc/gf.txt.

--- Additions to the input file ---
In category OPTIONS, add token

 SCR= #, where # signifies:
      0 do nothing
      1 Make ASA dielectric response function P0 for q->0; see above
        Result is store in file `psta'.
      2 Use psta to screen output q and ves
      3 Use psta to screen output ves only

      Also, you may add to #:
      Add 10*k to compute intra-site contribution to vbare each kth iteration
      Add 100*k to compute response function only each kth iteration
